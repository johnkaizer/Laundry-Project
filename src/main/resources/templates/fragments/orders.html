<div>
    <h3>Orders</h3>

    <!-- Search Input -->
    <input type="text" id="searchInput" class="search-bar" placeholder="Search orders...">

    <!-- Orders Table -->
    <table id="ordersTable" class="orders-table">
        <thead>
        <tr>
            <th>#</th>
            <th>Customer Phone Number</th>
            <th>Service Type</th>
            <th>Status</th>
            <th>Laundry Weight (kg)</th>
            <th>Total Amount (Ksh)</th>
            <th>Order Date</th>
            <th>Order Number</th>
        </tr>
        </thead>
        <tbody>
        <!-- Data will be dynamically filled here using JavaScript -->
        </tbody>
    </table>
</div>

<!-- Optional: Add some styles to make it look nice -->
<style>
    .orders-table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 20px;
    }

    .orders-table th, .orders-table td {
        padding: 10px;
        border: 1px solid #ddd;
        text-align: left;
    }

    .orders-table th {
        background-color: #f4f4f4;
    }

    .btn {
        padding: 5px 10px;
        margin: 0 5px;
        cursor: pointer;
    }

    .btn-primary {
        background-color: #1E90FF;
        color: #fff;
        border: none;
    }

    .btn-sm {
        font-size: 12px;
    }

    .btn-success {
        background-color: #28a745;
        color: #fff;
    }

    .btn-danger {
        background-color: #dc3545;
        color: #fff;
    }

    .btn:hover {
        opacity: 0.8;
    }

    .search-bar {
        margin-top: 15px;
        padding: 10px;
        width: 100%;
        box-sizing: border-box;
        font-size: 16px;
        border: 1px solid #ddd;
        border-radius: 4px;
    }
</style>

<!-- JavaScript for handling search functionality and loading orders -->
<script>
    // Fetch orders from the backend API and populate the table
    function loadOrders() {
        fetch('http://localhost:8080/api/orders')
            .then(response => response.json())
            .then(orders => {
                const tableBody = document.querySelector('#ordersTable tbody');
                tableBody.innerHTML = ''; // Clear any existing rows

                // Populate the table with the fetched orders
                orders.forEach((order, index) => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${index + 1}</td>
                        <td>${order.customerPhoneNumber}</td>
                        <td>${order.serviceType}</td>
                        <td>${order.status}</td>
                        <td>${order.laundryWeight}</td>
                        <td>${order.totalAmount}</td>
                        <td>${new Date(order.orderDate).toLocaleString()}</td>
                        <td>${order.orderNumber}</td>
                    `;
                    tableBody.appendChild(row);
                });
            })
            .catch(error => console.error('Error loading orders:', error));
    }

    // Call loadOrders function on page load
    window.onload = loadOrders;

    // Search Functionality
    document.getElementById('searchInput').addEventListener('keyup', function () {
        var input = document.getElementById('searchInput');
        var filter = input.value.toLowerCase();
        var table = document.getElementById('ordersTable');
        var tr = table.getElementsByTagName('tr');

        // Loop through all table rows, and hide those that don't match the search query
        for (var i = 1; i < tr.length; i++) {
            var tdArray = tr[i].getElementsByTagName('td');
            var rowContainsSearchTerm = false;

            // Loop through all columns in the row
            for (var j = 0; j < tdArray.length; j++) {
                if (tdArray[j]) {
                    var cellValue = tdArray[j].textContent || tdArray[j].innerText;
                    if (cellValue.toLowerCase().indexOf(filter) > -1) {
                        rowContainsSearchTerm = true;
                        break;
                    }
                }
            }

            // Show or hide the row based on the search query
            if (rowContainsSearchTerm) {
                tr[i].style.display = "";
            } else {
                tr[i].style.display = "none";
            }
        }
    });
</script>
